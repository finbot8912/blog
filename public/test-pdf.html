<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF ë¡œë“œ í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #1a1a1a;
            color: #fff;
        }
        .test-box {
            background: #2a2a2a;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        .success { color: #4ade80; }
        .error { color: #f87171; }
        .warning { color: #fbbf24; }
        button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        button:hover {
            background: #2563eb;
        }
        pre {
            background: #000;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>ğŸ” PDF ì°¸ì¡° ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸</h1>
    
    <div class="test-box">
        <h2>1. PDF íŒŒì¼ ì ‘ê·¼ í…ŒìŠ¤íŠ¸</h2>
        <button onclick="testPdfAccess()">PDF íŒŒì¼ ì ‘ê·¼ í™•ì¸</button>
        <pre id="access-result">ëŒ€ê¸° ì¤‘...</pre>
    </div>

    <div class="test-box">
        <h2>2. PDF.jsë¡œ í…ìŠ¤íŠ¸ ì¶”ì¶œ í…ŒìŠ¤íŠ¸</h2>
        <button onclick="testPdfExtraction()">PDF í…ìŠ¤íŠ¸ ì¶”ì¶œ</button>
        <pre id="extract-result">ëŒ€ê¸° ì¤‘...</pre>
    </div>

    <div class="test-box">
        <h2>3. íƒˆëª¨ í‚¤ì›Œë“œ ê°ì§€ í…ŒìŠ¤íŠ¸</h2>
        <input type="text" id="test-topic" value="ë¯¸ë…¹ì‹œë”œ íš¨ê³¼" style="width: 300px; padding: 8px; background: #000; color: #fff; border: 1px solid #444;">
        <button onclick="testKeywordDetection()">í‚¤ì›Œë“œ ê°ì§€ í…ŒìŠ¤íŠ¸</button>
        <pre id="keyword-result">ëŒ€ê¸° ì¤‘...</pre>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script>
        // PDF.js worker ì„¤ì •
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

        async function testPdfAccess() {
            const resultEl = document.getElementById('access-result');
            resultEl.textContent = 'í…ŒìŠ¤íŠ¸ ì¤‘...';
            
            try {
                const response = await fetch('/book.pdf');
                const data = {
                    status: response.status,
                    statusText: response.statusText,
                    ok: response.ok,
                    size: response.headers.get('content-length')
                };
                
                if (response.ok) {
                    resultEl.innerHTML = `<span class="success">âœ… ì„±ê³µ!</span>\n${JSON.stringify(data, null, 2)}`;
                } else {
                    resultEl.innerHTML = `<span class="error">âŒ ì‹¤íŒ¨</span>\n${JSON.stringify(data, null, 2)}`;
                }
            } catch (error) {
                resultEl.innerHTML = `<span class="error">âŒ ì˜¤ë¥˜</span>\n${error.message}`;
            }
        }

        async function testPdfExtraction() {
            const resultEl = document.getElementById('extract-result');
            resultEl.textContent = 'PDF ë¡œë“œ ì¤‘...';
            
            try {
                const loadingTask = pdfjsLib.getDocument('/book.pdf');
                const pdf = await loadingTask.promise;
                
                resultEl.textContent = `PDF ë¡œë“œ ì™„ë£Œ! ì´ ${pdf.numPages} í˜ì´ì§€\n\nì²« í˜ì´ì§€ í…ìŠ¤íŠ¸ ì¶”ì¶œ ì¤‘...`;
                
                const page = await pdf.getPage(1);
                const textContent = await page.getTextContent();
                const pageText = textContent.items.map(item => item.str).join(' ');
                
                const preview = pageText.substring(0, 500);
                resultEl.innerHTML = `<span class="success">âœ… ì„±ê³µ!</span>
ì´ í˜ì´ì§€: ${pdf.numPages}
ì²« í˜ì´ì§€ í…ìŠ¤íŠ¸ ê¸¸ì´: ${pageText.length}ì

ë¯¸ë¦¬ë³´ê¸°:
${preview}...`;
            } catch (error) {
                resultEl.innerHTML = `<span class="error">âŒ ì˜¤ë¥˜</span>\n${error.message}`;
            }
        }

        function testKeywordDetection() {
            const topic = document.getElementById('test-topic').value;
            const resultEl = document.getElementById('keyword-result');
            
            const hairLossKeywords = [
                'íƒˆëª¨', 'ëª¨ë°œ', 'ë‘í”¼', 'í—¤ì–´', 'ë¨¸ë¦¬ì¹´ë½', 'ëª¨ê·¼', 'ëª¨ë‚­',
                'ëŒ€ë¨¸ë¦¬', 'ì›í˜• íƒˆëª¨', 'ì§€ë£¨ì„± íƒˆëª¨', 'Mì íƒˆëª¨',
                'í”¼ë‚˜ìŠ¤í…Œë¦¬ë“œ', 'ë‘íƒ€ìŠ¤í…Œë¦¬ë“œ', 'ë¯¸ë…¹ì‹œë”œ', 'í”„ë¡œí˜ì‹œì•„', 'ì•„ë³´ë‹¤íŠ¸',
                'ëª¨ë°œ ì´ì‹', 'ëª¨ë°œ ê±´ê°•', 'ë‘í”¼ ê±´ê°•', 'ìƒ´í‘¸', 'íŠ¸ë¦¬íŠ¸ë¨¼íŠ¸',
                'ë°œëª¨', 'ìœ¡ëª¨', 'ì•ë¨¸ë¦¬', 'ì •ìˆ˜ë¦¬', 'ê°€ë¥´ë§ˆ'
            ];
            
            const lowerTopic = topic.toLowerCase();
            const matched = hairLossKeywords.filter(keyword => 
                lowerTopic.includes(keyword.toLowerCase())
            );
            
            if (matched.length > 0) {
                resultEl.innerHTML = `<span class="success">âœ… íƒˆëª¨ ê´€ë ¨ ì£¼ì œ ê°ì§€ë¨!</span>
                
ë§¤ì¹­ëœ í‚¤ì›Œë“œ: ${matched.join(', ')}
ì£¼ì œ: ${topic}`;
            } else {
                resultEl.innerHTML = `<span class="warning">âš ï¸ íƒˆëª¨ ê´€ë ¨ í‚¤ì›Œë“œ ì—†ìŒ</span>
                
ì£¼ì œ: ${topic}
ë§¤ì¹­ëœ í‚¤ì›Œë“œ ì—†ìŒ`;
            }
        }
    </script>
</body>
</html>

